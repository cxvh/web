/**
 * Created by Administrator on 2016/6/28.
 */
/****** 闭包 ******/(function(c){var f=function(c){var a=["webkit","Moz","o","ms"],b="",e;for(e in a)if(b=a[e]+"Transition",void 0!==c.style[b])return"-"+a[e].toLowerCase()+"-";return!1}(document.createElement(g)),g=function(){function d(a,b){this.settings=c.extend(!0,c.fn.PageSwitch.defaults,b||{});this.element=a;this.init()}d.prototype={init:function(){this.selectors=this.settings.selectors;this.sections=this.element.find(this.selectors.sections);this.section=this.sections.find(this.selectors.section);this.direction="vertical"==this.settings.direction?!0:!1;this.pagesCount=this.pagesCount();this.index=0<=this.settings.index&&this.settings.index<this.pagesCount?this.settings.index:0;this.canScroll=!0;this.direction||this._initLayout(this.pagesCount);this.settings.pagination&&this._initPaging();this._initEvent()},pagesCount:function(){return this.section.length},switchLength:function(){return this.direction?this.element.height():this.element.width()},prev:function(){0<this.index?this.index--:this.settings.loop&&(this.index=this.pagesCount-1);this._scrollPage()},next:function(){this.index<this.pagesCount?this.index++:this.settings.loop&&(this.index=0);this._scrollPage()},_initLayout:function(a){var b=100*a+"%";a=(100/a).toFixed(2)+"%";this.sections.width(b);this.section.width(a).css("float","left")},_initPaging:function(){var a=this.selectors.page.substring(1);this.activeClass=this.selectors.active.substring(1);for(var a="\x3cdiv class\x3d"+a+"\x3e\x3cul\x3e",b=0;b<this.pagesCount;b++)a+="\x3cli\x3e\x3c/li\x3e";this.element.append(a+"\x3c/ul\x3e\x3c/div\x3e");a=this.element.find(this.selectors.page);this.pageItem=a.find("li");this.pageItem.eq(this.index).addClass(this.activeClass);this.direction?a.addClass("vertical"):a.addClass("horizontal")},_initEvent:function(){var a=this;a.element.on("click",a.selectors.page+" li",function(){a.index=c(this).index();a._scrollPage()});a.element.on("mousewheel DOMMouseScroll",function(b){b=b.originalEvent.wheelDelta||b.originalEvent.detail;0<b&&(a.index&&!a.settings.loop||a.settings.loop)?a.prev():0>b&&(a.index<a.pagesCount-1&&!a.settings.loop||a.settings.loop)&&a.next()});if(a.settings.keyboard)c(window).on("keyup",function(b){b=b.keyCode;37==b||38==b?a.prev():39!=b&&40!=b||a.next()});c(window).resize(function(){var b=a.switchLength(),c=a.settings.direction?a.section.eq(a.index).offset().top:a.section.eq(a.index).offset().left;Math.abs(c)>b/2&&a.index<a.pagesCount-1&&a.index++;a.index&&a._scrollPage()});a.sections.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(){a.canScroll=!0;a.settings.callback&&"function"==c.type(a.settings.callback)&&a.settings.callback()})},_scrollPage:function(){var a=this,b=a.section.eq(a.index).position();b&&(a.canScroll=!1,f?(a.sections.css(f+"transition","all "+a.settings.duration+"ms "+a.settings.easing),a.sections.css(f+"transform",a.direction?"translateY(-"+b.top+"px)":"translateX(-"+b.left+"px)")):a.sections.animate(a.direction?{top:-b.top}:{left:-b.left},a.sections.direction,function(){a.canScroll=!0;a.settings.callback&&"function"==c.type(a.settings.callback)&&a.settings.callback()}),a.settings.pagination&&a.pageItem.eq(a.index).addClass(a.activeClass).siblings("li").removeClass(a.activeClass))}};return d}();c.fn.PageSwitch=function(d){return this.each(function(){var a=c(this),b=a.data("PageSwitch");b||(b=new g(a,d),a.data("PageSwitch",b));if("string"===c.type(d))return b[d]()})};c.fn.PageSwitch.defaults={selectors:{sections:".sections",section:".section",page:".pages",active:".active"},index:0,easing:"ease",duration:500,loop:!1,pagination:!0,keyboard:!0,direction:"vertical",callback:""};c(function(){c("[data-PageSwitch]").PageSwitch()})})(jQuery);